<!doctype html>
<html lang=en>

<head>
    <meta charset=utf-8>
    <title>Authorize</title>
</head>

<body>
    <button type=button>Click to authorize</button>
    <script src="../js/constants.js"></script>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
        var t = window.TrelloPowerUp.iframe({
            appKey: KEY,
            appName: POWERUP_NAME
        });
        t.render(function () {
            document.querySelector('button').addEventListener('click', function () {
                t.getRestApi()
                    .authorize({ scope: 'read,write' })
                    .then(function (t) {
                        alert('Success!');
                    }).catch(TrelloPowerUp.restApiError.AuthDeniedError, function () {
                        alert('Cancelled!');
                    });
            }, false);
        });
    </script>
</body>

</html>